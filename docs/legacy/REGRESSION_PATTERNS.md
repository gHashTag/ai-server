# –ü–∞—Ç—Ç–µ—Ä–Ω—ã –†–µ–≥—Ä–µ—Å—Å–∏–π (REGRESSION_PATTERNS.md)

## üïâÔ∏è –ê–Ω—Ç–∏-–ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –£—Ä–æ–∫–∏ –û—à–∏–±–æ–∫

_–û–±–Ω–æ–≤–ª–µ–Ω–æ: 2024-12-19_

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å FormData –∏ Multer

**–ü—Ä–æ–±–ª–µ–º–∞:** `Error: Unexpected end of form` –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ multipart/form-data  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –≠–Ω–¥–ø–æ–∏–Ω—Ç `/api/generate/create-model-training`  
**–ü—Ä–∏—á–∏–Ω—ã:**

- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ middleware `multer` –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ FormData –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–µ—Ä–µ–¥–∞—á–µ–π —Ñ–∞–π–ª–æ–≤—ã—Ö –ø–æ—Ç–æ–∫–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**

- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ `fileUpload` middleware –∫ –º–∞—Ä—à—Ä—É—Ç–∞–º, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–º —Ñ–∞–π–ª—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ FormData –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–ª–∏—á–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

**–ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω:** –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –±–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ middleware

---

### ‚ùå –û—à–∏–±–∫–∏ –¢–∏–ø–æ–≤ –≤ Runtime

**–ü—Ä–æ–±–ª–µ–º–∞:** `TypeError: calculateModeCost[ModeEnum.DigitalAvatarBody] is not a function`  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –í—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –∫–ª—é—á–∞–º–∏  
**–ü—Ä–∏—á–∏–Ω—ã:**

- –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É enum –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ –∫–ª—é—á–∞–º–∏ –æ–±—ä–µ–∫—Ç–∞
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º
- –ü—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–±–æ—Ä–∫–æ–π/–∏–º–ø–æ—Ä—Ç–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ:**

- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º (`bun exec tsc --noEmit`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `in` –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏–ª–∏ `hasOwnProperty` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π
- –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ç–∏–ø–∞—Ö/enum

**–ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º –æ–±—ä–µ–∫—Ç–∞ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è

---

### ‚ùå NaN –≤ –§–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –û–ø–µ—Ä–∞—Ü–∏—è—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ `NaN` –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –±–∞–ª–∞–Ω—Å–µ  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –û–ø–µ—Ä–∞—Ü–∏–∏ —Å–ø–∏—Å–∞–Ω–∏—è/–Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–≤–µ–∑–¥  
**–ü—Ä–∏—á–∏–Ω—ã:**

- –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏–ª–∏ undefined
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**

- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ —á–∏—Å–ª—É: `Number(value)` –∏–ª–∏ `parseFloat(value)`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ `isNaN()` –ø–æ—Å–ª–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `value || 0`

**–ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω:** –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

---

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –õ–∏–Ω—Ç–µ—Ä–æ–º –∏ Next Parameter

**–ü—Ä–æ–±–ª–µ–º–∞:** ESLint –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ `next` –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ Express middleware  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ú–µ—Ç–æ–¥—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫  
**–ü—Ä–∏—á–∏–Ω—ã:**

- –ù–µ–ø–æ–ª–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `next` –ø–∞—Ä–∞–º–µ—Ç—Ä–∞)
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ —Å –Ω–µ–ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**

- –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–æ–ª–Ω—É—é —Å–∏–≥–Ω–∞—Ç—É—Ä—É `(req, res, next)` –≤ Express –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `next` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –æ—à–∏–±–æ–∫ –≤ error handler
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

**–ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω:** –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ `next` –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ Express middleware

---

### ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –¢–æ–∫–µ–Ω–æ–≤ Telegram Bot

**–ü—Ä–æ–±–ª–µ–º–∞:** `TelegramError: 401: Unauthorized`  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ—Ç—ã —Å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏  
**–ü—Ä–∏—á–∏–Ω—ã:**

- –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∏–ª–∏ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏ –±–æ—Ç–æ–≤
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**

- –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

---

## üõ°Ô∏è –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ú–µ—Ä—ã

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ü—Ä–æ–≤–µ—Ä–∫–∏

1. **–¢–∏–ø—ã:** `bun exec tsc --noEmit` –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º
2. **–°–±–æ—Ä–∫–∞:** `bun run build` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
3. **–õ–∏–Ω—Ç–µ—Ä:** `bun run lint` –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∫–æ–¥–∞
4. **–¢–µ—Å—Ç—ã:** –ó–∞–ø—É—Å–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –ø–µ—Ä–µ–¥ –¥–æ—Å—Ç—É–ø–æ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ü—Ä–∏–Ω—Ü–∏–ø—ã

- –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –ò–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ —Ä–µ—à–µ–Ω–∏–π
