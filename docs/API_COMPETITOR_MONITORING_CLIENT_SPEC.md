# üìã –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï: API –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê –ö–û–ù–ö–£–†–ï–ù–¢–û–í

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Instagram –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º —á–µ—Ä–µ–∑ Apify –∏ –¥–æ—Å—Ç–∞–≤–∫–æ–π —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–æ–≤.

### –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ Instagram
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ —Ä–∏–ª—Å–æ–≤ –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º, –≤–æ–∑—Ä–∞—Å—Ç—É –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –î–æ—Å—Ç–∞–≤–∫–∞ –≤ Telegram (–¥–∞–π–¥–∂–µ—Å—Ç, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ, –∞—Ä—Ö–∏–≤)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ **–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–∏–ª—Å–∞** –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏

---

## üåê –ë–ê–ó–û–í–´–ï URL

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```
http://localhost:3000
```

### –ü—Ä–æ–¥–∞–∫—à–Ω:
```
https://your-production-domain.com
```

---

## üîß API ENDPOINTS

### 1. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞

**POST** `/api/competitor-monitoring`

–°–æ–∑–¥–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "username": "natgeo",                    // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: username –±–µ–∑ @
  "user_telegram_id": "144022504",         // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
  "bot_name": "neuro_blogger_bot",         // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –∏–º—è –±–æ—Ç–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
  "max_reels": 10,                         // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–∞–∫—Å –∫–æ–ª-–≤–æ —Ä–∏–ª—Å–æ–≤ (1-50, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
  "min_views": 1000,                       // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–∏–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1000)
  "max_age_days": 7,                       // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–∞–∫—Å –≤–æ–∑—Ä–∞—Å—Ç –≤ –¥–Ω—è—Ö (1-30, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7)
  "delivery_format": "digest",             // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: digest|individual|archive (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é digest)
  "project_id": 123                        // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: ID –ø—Ä–æ–µ–∫—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)
}
```

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "message": "Monitoring for @natgeo started successfully",
  "event_id": "01J6X8Q2...",
  "competitor_username": "natgeo",
  "expected_reels": 10,
  "monitoring_enabled": true,
  "next_check": "Daily at 08:00 UTC",
  "delivery_format": "digest"
}
```

#### –û—à–∏–±–∫–∏:
```json
{
  "success": false,
  "error": "Invalid request data",
  "details": [
    {
      "path": ["username"],
      "message": "Required"
    }
  ]
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**GET** `/api/competitor-monitoring/status/:username?user_telegram_id=XXX&bot_name=XXX`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∏–ª—Å—ã.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `username` - username –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ (–≤ URL)
- `user_telegram_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (query –ø–∞—Ä–∞–º–µ—Ç—Ä)
- `bot_name` - –∏–º—è –±–æ—Ç–∞ (query –ø–∞—Ä–∞–º–µ—Ç—Ä)

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```
GET /api/competitor-monitoring/status/natgeo?user_telegram_id=144022504&bot_name=neuro_blogger_bot
```

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "monitoring": true,
  "subscription": {
    "id": "uuid-here",
    "competitor_username": "natgeo",
    "display_name": "National Geographic",
    "max_reels": 10,
    "min_views": 1000,
    "max_age_days": 7,
    "delivery_format": "digest",
    "is_active": true,
    "created_at": "2024-01-01T00:00:00Z",
    "last_delivery": "2024-01-02T08:00:00Z",
    "last_delivery_reels_count": 5
  },
  "reels_in_database": 25,
  "latest_reels": [
    {
      "url": "https://instagram.com/p/XXX",
      "views_count": 500000,
      "likes_count": 15000,
      "published_at": "2024-01-02T12:00:00Z"
    }
  ],
  "monitoring": {
    "enabled": true,
    "check_interval": "24 hours",
    "next_check": "Daily at 08:00 UTC"
  }
}
```

### 3. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –¥–æ—Å—Ç–∞–≤–∫–∏

**POST** `/api/competitor-monitoring/trigger-delivery/:username`

–ó–∞–ø—É—Å–∫–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É –≤—Ä—É—á–Ω—É—é (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è).

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "project_id": 999  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 999 –¥–ª—è –∞–≤—Ç–æ-–ø–æ–¥–ø–∏—Å–æ–∫
}
```

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```
POST /api/competitor-monitoring/trigger-delivery/natgeo
```

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "message": "Delivery triggered for @natgeo",
  "event_id": "01J6X8Q2..."
}
```

---

## üîÑ –ü–†–û–¶–ï–°–° –†–ê–ë–û–¢–´ –°–ò–°–¢–ï–ú–´

### 1. –ü—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ (`POST /api/competitor-monitoring`):
1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
2. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Supabase
3. **–ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞** - Apify –ø–∞—Ä—Å–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∏–ª—Å—ã
4. **–û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** - —Å–∏—Å—Ç–µ–º–∞ –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞
5. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∏–ª—Å–æ–≤
6. **–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram** - –¥–æ—Å—Ç–∞–≤–∫–∞ **–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–∏–ª—Å–∞** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
7. **–ó–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
8. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º –ø—Ä–æ–≤–µ—Ä–∫–∞–º

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞ –≤ 08:00 UTC):
1. **–ü–æ–∏—Å–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫** - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
2. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞
3. **–ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ** - Apify –ø–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤—ã—Ö —Ä–∏–ª—Å–æ–≤
4. **–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Telegram
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏** - –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞

### 3. –î–æ—Å—Ç–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤** - –∫—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–µ–∂–∏—Ö —Ä–∏–ª—Å–æ–≤** - —Ä–∏–ª—Å—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º** - views, age, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
4. **–î–æ—Å—Ç–∞–≤–∫–∞ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ**:
   - **digest** - —Å–≤–æ–¥–∫–∞ —Å —Ç–æ–ø-—Ä–∏–ª—Å–æ–º
   - **individual** - –∫–∞–∂–¥—ã–π —Ä–∏–ª—Å –æ—Ç–¥–µ–ª—å–Ω–æ
   - **archive** - Excel —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ —Ä–∏–ª—Å–∞–º–∏

---

## üì± –§–û–†–ú–ê–¢–´ –î–û–°–¢–ê–í–ö–ò –í TELEGRAM

### Digest (–¥–∞–π–¥–∂–µ—Å—Ç):
```
üé¨ –î–∞–π–¥–∂–µ—Å—Ç —Ä–∏–ª—Å–æ–≤ @natgeo

üìä –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞:
‚Ä¢ –ù–æ–≤—ã—Ö —Ä–∏–ª—Å–æ–≤: 5
‚Ä¢ –û–±—â–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã: 2,500,000
‚Ä¢ –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã: 500,000

üèÜ –¢–æ–ø —Ä–∏–ª—Å (1,200,000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤):
Amazing wildlife footage from Africa...

üîó https://instagram.com/p/XXX

üìã –ï—â–µ 4 —Ä–∏–ª—Å–æ–≤ –≤ —Å–ø–∏—Å–∫–µ
```

### Individual (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ):
```
üé¨ –ù–æ–≤—ã–π —Ä–∏–ª—Å –æ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞

üëÄ –ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: 500,000
‚ù§Ô∏è –õ–∞–π–∫–æ–≤: 15,000
üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤: 1,200

Amazing wildlife footage...

üîó https://instagram.com/p/XXX
```

### Archive (–∞—Ä—Ö–∏–≤):
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è Excel —Ñ–∞–π–ª —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
- URL
- –ü—Ä–æ—Å–º–æ—Ç—Ä—ã
- –õ–∞–π–∫–∏
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- –û–ø–∏—Å–∞–Ω–∏–µ

---

## üîë –ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã:

```bash
# Supabase
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Apify (–¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ Instagram)
APIFY_TOKEN=apify_api_xxxxx
APIFY_INSTAGRAM_ACTOR_ID=apify/instagram-reel-scraper

# Inngest (–¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π)
INNGEST_EVENT_KEY=evt_xxxxx
INNGEST_SIGNING_KEY=signkey_xxxxx

# Telegram –±–æ—Ç—ã (–º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω)
BOT_TOKEN_1=7654321098:AAFxxxxx  # neuro_blogger_bot
BOT_TOKEN_2=1234567890:AAGxxxxx  # MetaMuse_Manifest_bot
# ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–æ—Ç—ã

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –∞–¥–º–∏–Ω —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
ADMIN_CHAT_ID=-1001234567890

# –°–µ—Ä–≤–µ—Ä
PORT=3000
NODE_ENV=production  # –∏–ª–∏ development
```

---

## üöÄ –õ–û–ö–ê–õ–¨–ù–ê–Ø –£–°–¢–ê–ù–û–í–ö–ê –ò –ó–ê–ü–£–°–ö

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
git clone https://github.com/your-repo/ai-server.git
cd ai-server
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
```

### 3. –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```bash
npm run dev
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3000`

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã API:
```bash
# –¢–µ—Å—Ç –ø–æ–¥–ø–∏—Å–∫–∏
curl -X POST http://localhost:3000/api/competitor-monitoring \
  -H "Content-Type: application/json" \
  -d '{
    "username": "natgeo",
    "user_telegram_id": "144022504",
    "bot_name": "neuro_blogger_bot",
    "max_reels": 5
  }'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl "http://localhost:3000/api/competitor-monitoring/status/natgeo?user_telegram_id=144022504&bot_name=neuro_blogger_bot"
```

---

## üåç –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï –í –ü–†–û–î–ê–ö–®–ù

### –û–ø—Ü–∏—è 1: Railway (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Railway CLI
npm install -g @railway/cli

# –õ–æ–≥–∏–Ω –≤ Railway
railway login

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
railway new

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
railway variables set SUPABASE_URL=https://xxxxx.supabase.co
railway variables set SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI...
# ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

# –î–µ–ø–ª–æ–π
railway deploy
```

### –û–ø—Ü–∏—è 2: Docker
```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t ai-server .

# –ó–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker run -d \
  --name ai-server \
  -p 3000:3000 \
  -e SUPABASE_URL=https://xxxxx.supabase.co \
  -e SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI... \
  -e BOT_TOKEN_1=7654321098:AAFxxxxx \
  ai-server
```

### –û–ø—Ü–∏—è 3: PM2 (VPS)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2
npm install -g pm2

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 start npm --name "ai-server" -- start

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
pm2 save
pm2 startup
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´

### 1. –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç API:
```javascript
// test-api.js
const response = await fetch('http://localhost:3000/api/competitor-monitoring', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    username: 'natgeo',
    user_telegram_id: '144022504',
    bot_name: 'neuro_blogger_bot',
    max_reels: 3
  })
})

const result = await response.json()
console.log('–ü–æ–¥–ø–∏—Å–∫–∞ —Å–æ–∑–¥–∞–Ω–∞:', result)
```

### 2. –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
node test-competitor-monitoring-simple.js
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –ò–º–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Supabase
- ‚úÖ –°—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Apify
- ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (8 —à–∞–≥–æ–≤)

---

## üìä –°–¢–†–£–ö–¢–£–†–ê –ë–ê–ó–´ –î–ê–ù–ù–´–• (Supabase)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

#### `competitor_subscriptions`
- `id` - UUID –ø–æ–¥–ø–∏—Å–∫–∏
- `competitor_username` - username –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
- `user_telegram_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
- `bot_name` - –∏–º—è –±–æ—Ç–∞
- `max_reels` - –º–∞–∫—Å–∏–º—É–º —Ä–∏–ª—Å–æ–≤
- `min_views` - –º–∏–Ω–∏–º—É–º –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- `max_age_days` - –º–∞–∫—Å–∏–º—É–º –¥–Ω–µ–π
- `delivery_format` - —Ñ–æ—Ä–º–∞—Ç –¥–æ—Å—Ç–∞–≤–∫–∏
- `is_active` - –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞
- `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `last_parsed_at` - –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–∞—Ä—Å–∏–Ω–≥
- `next_parse_at` - —Å–ª–µ–¥—É—é—â–∏–π –ø–∞—Ä—Å–∏–Ω–≥

#### `instagram_apify_reels`
- `id` - UUID —Ä–∏–ª—Å–∞
- `reel_id` - ID —Ä–∏–ª—Å–∞ Instagram
- `url` - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∏–ª—Å
- `owner_username` - –≤–ª–∞–¥–µ–ª–µ—Ü —Ä–∏–ª—Å–∞
- `views_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- `likes_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤
- `caption` - –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∏–ª—Å–∞
- `published_at` - –¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `scraped_at` - –¥–∞—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

#### `competitor_delivery_history`
- `id` - UUID –∑–∞–ø–∏—Å–∏
- `subscription_id` - —Å–≤—è–∑—å —Å –ø–æ–¥–ø–∏—Å–∫–æ–π
- `delivery_status` - —Å—Ç–∞—Ç—É—Å –¥–æ—Å—Ç–∞–≤–∫–∏
- `reels_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∏–ª—Å–æ–≤
- `delivered_at` - –¥–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### 1. –õ–∏–º–∏—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- **–ú–∞–∫—Å–∏–º—É–º —Ä–∏–ª—Å–æ–≤ –∑–∞ —Ä–∞–∑:** 50
- **–ß–∞—Å—Ç–æ—Ç–∞ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥–∞:** –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞:** 30 –¥–Ω–µ–π
- **–õ–∏–º–∏—Ç Apify:** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∞—Ä–∏—Ñ–∞

### 2. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏–∫–∏:
- ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **–ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∏–ª—Å** (–Ω–µ –ª—É—á—à–∏–π) –¥–ª—è –ø–æ–∫–∞–∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–ª–∏–∫–∞—Ç–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ Apify
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Ä–∏–ª—Å–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- –õ–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –∫–æ–Ω—Å–æ–ª—å
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –ë–î

---

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

### –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –ª–æ–≥–æ–≤:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Inngest Dashboard
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ API

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **"Supabase error"** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. **"Apify timeout"** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω Apify –∏ –ª–∏–º–∏—Ç—ã
3. **"Bot not found"** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω—ã –±–æ—Ç–æ–≤
4. **"No reels found"** - –∞–∫–∫–∞—É–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º

---

## üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–Ø –ò –ú–ò–ì–†–ê–¶–ò–ò

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã:
1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
2. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ API

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: 2024-12-21*
*–í–µ—Ä—Å–∏—è API: 1.0*
*–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É*